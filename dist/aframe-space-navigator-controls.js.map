{"version":3,"file":"aframe-space-navigator-controls.js","sources":["../src/aframe-space-navigator-controls.js"],"sourcesContent":["/**\r\n * Space Navigator Controls Component for A-Frame.\r\n *\r\n * Forked from:\r\n * https://developer.mozilla.org/en-US/docs/Web/API/Gamepad_API/Using_the_Gamepad_API\r\n *\r\n */\r\n\r\n;(function (AFRAME) {\r\n\r\n  var MAX_DELTA = 200, // ms\r\n      PI_2 = Math.PI / 2,\r\n      DEG_TO_RAD = 1 / 180 * Math.PI,\r\n      RAD_TO_DEG = 180 / Math.PI,\r\n      ROTATION_EPS = 0.000,\r\n      MOVEMENT_EPS = 0.000\r\n\r\n  // component definition\r\n\r\n  var spaceNavigatorControls = {\r\n\r\n    /*******************************************************************\r\n     * Schema\r\n     */\r\n\r\n    schema: {\r\n      // Controller 0-3\r\n      controller:        { default: 0, oneOf: [0, 1, 2, 3] },\r\n\r\n      // Enable/disable features\r\n      enabled:           { default: true },\r\n      movementEnabled:   { default: true },\r\n      lookEnabled:       { default: true },\r\n      flyEnabled:        { default: true },\r\n      invertPitch:       { default: false },\r\n      rollEnabled:       { default: true },\r\n\r\n      // Constants\r\n      rotationSensitivity:  { default: 0.05 },\r\n      movementEasing:       { default: 3 },\r\n      movementAcceleration: { default: 700 },\r\n\r\n      // Debugging\r\n      debug:             { default: false }\r\n    },\r\n\r\n    /*******************************************************************\r\n     * Core\r\n     */\r\n\r\n    /**\r\n     * Called once when component is attached. Generally for initial setup.\r\n     */\r\n    init: function () {\r\n\r\n      var self = this\r\n      var el = this.el\r\n\r\n      // Movement\r\n      this.movementVelocity = new THREE.Vector3(0, 0, 0)\r\n      this.movementDirection = new THREE.Vector3(0, 0, 0)\r\n      this.fovVelocity = 0\r\n\r\n      // Rotation\r\n      this.pitch = new THREE.Object3D()\r\n      this.roll = new THREE.Object3D()\r\n      this.yaw = new THREE.Object3D()\r\n      this.yaw.position.y = 10\r\n      this.yaw.add(this.pitch)\r\n\r\n      // Button state\r\n      this.buttons = {}\r\n\r\n      // scroll wheel\r\n      this.scroll = 0\r\n      this.scrollDelta = 0\r\n      // IE, Opera, Google Chrome, Safari\r\n      document.addEventListener('mousewheel', function(event){\r\n        event.preventDefault()\r\n        self.scroll -= event.wheelDelta / 60\r\n      })\r\n      // Firefox\r\n      document.addEventListener('DOMMouseScroll', function(event){\r\n        event.preventDefault()\r\n        self.scroll += event.detail\r\n      })\r\n\r\n      if (!this.getSpaceNavigator()) {\r\n        console.warn(\r\n          'Space Navigator not found. Connect and press any button to continue.',\r\n          this.data.controller\r\n        )\r\n      }\r\n    },\r\n\r\n    /**\r\n     * Called on each iteration of main render loop.\r\n     */\r\n    tick: function (t, dt) {\r\n      this.updateRotation(dt)\r\n      this.updatePosition(dt)\r\n      this.updateButtonState()\r\n      this.updateFov(dt)\r\n    },\r\n\r\n    /*******************************************************************\r\n     * Movement\r\n     */\r\n\r\n    updatePosition: function (dt) {\r\n      var data = this.data\r\n      var acceleration = data.movementAcceleration\r\n      var easing = data.movementEasing\r\n      var velocity = this.movementVelocity\r\n      var el = this.el\r\n      var spaceNavigator = this.getSpaceNavigator()\r\n\r\n      // If data has changed or FPS is too low\r\n      // we reset the velocity\r\n      if (dt > MAX_DELTA) {\r\n        velocity.x = 0\r\n        velocity.x = 0\r\n        velocity.z = 0\r\n        return\r\n      }\r\n\r\n      velocity.z -= velocity.z * easing * dt / 1000\r\n      velocity.x -= velocity.x * easing * dt / 1000\r\n      velocity.y -= velocity.y * easing * dt / 1000\r\n\r\n      var position = el.getAttribute('position')\r\n\r\n      if (data.enabled && data.movementEnabled && spaceNavigator) {\r\n\r\n        /*\r\n         * 3dconnexion space mouse axes\r\n         *\r\n         * \"right handed coordinate system\"\r\n         * 0: - left / + right (pos: X axis pointing to the right)\r\n         * 1: - backwards / + forward (pos: Z axis pointing forwards)\r\n         * 2: - up / + down (pos: Y axis pointing down)\r\n         */\r\n\r\n        var xDelta = spaceNavigator.axes[0],\r\n            yDelta = spaceNavigator.axes[2],\r\n            zDelta = spaceNavigator.axes[1]\r\n\r\n        velocity.x += xDelta * acceleration * dt / 1000\r\n        velocity.z += zDelta * acceleration * dt / 1000\r\n        velocity.y -= yDelta * acceleration * dt / 1000\r\n\r\n      }\r\n\r\n      var movementVector = this.getMovementVector(dt);\r\n\r\n      el.object3D.position.add(movementVector)\r\n\r\n      el.setAttribute('position', {\r\n        x: position.x + movementVector.x,\r\n        y: position.y + movementVector.y,\r\n        z: position.z + movementVector.z\r\n      });\r\n    },\r\n\r\n    getMovementVector: function (dt) {\r\n      if (this._getMovementVector) return this._getMovementVector(dt)\r\n\r\n      var euler = new THREE.Euler(0, 0, 0, 'YXZ'),\r\n          rotation = new THREE.Vector3(),\r\n          direction = this.movementDirection,\r\n          velocity = this.movementVelocity\r\n\r\n      this._getMovementVector = function (dt) {\r\n        rotation.copy(this.el.getAttribute('rotation'))\r\n        direction.copy(velocity)\r\n        direction.multiplyScalar(dt / 1000)\r\n        if (!rotation) return direction\r\n        if (!this.data.flyEnabled) rotation.x = 0\r\n        euler.set(rotation.x * DEG_TO_RAD, rotation.y * DEG_TO_RAD, rotation.z * DEG_TO_RAD )\r\n        direction.applyEuler(euler)\r\n        return direction\r\n      }\r\n\r\n      return this._getMovementVector(dt)\r\n    },\r\n\r\n    /*******************************************************************\r\n     * Rotation\r\n     */\r\n\r\n    updateRotation: function () {\r\n      if (this._updateRotation) return this._updateRotation();\r\n\r\n      var initialRotation = new THREE.Vector3(),\r\n          prevInitialRotation = new THREE.Vector3(),\r\n          prevFinalRotation = new THREE.Vector3();\r\n\r\n      var tCurrent,\r\n          tLastLocalActivity = 0,\r\n          tLastExternalActivity = 0;\r\n\r\n      var rotationEps = 0.0001,\r\n          debounce = 500;\r\n\r\n      this._updateRotation = function () {\r\n\r\n        var spaceNavigator = this.getSpaceNavigator()\r\n\r\n        if (!this.data.lookEnabled || !spaceNavigator) return;\r\n\r\n        tCurrent = Date.now();\r\n        initialRotation.copy(this.el.getAttribute('rotation') || initialRotation);\r\n\r\n        // If initial rotation for this frame is different from last frame, and\r\n        // doesn't match last spaceNavigator state, assume an external component is\r\n        // active on this element.\r\n        if (initialRotation.distanceToSquared(prevInitialRotation) > rotationEps\r\n            && initialRotation.distanceToSquared(prevFinalRotation) > rotationEps) {\r\n          prevInitialRotation.copy(initialRotation);\r\n          tLastExternalActivity = tCurrent;\r\n          return;\r\n        }\r\n\r\n        prevInitialRotation.copy(initialRotation);\r\n\r\n        // If external controls have been active in last 500ms, wait.\r\n        if (tCurrent - tLastExternalActivity < debounce) return\r\n\r\n        /*\r\n         * 3dconnexion space mouse axes\r\n         *\r\n         * \"right handed coordinate system\"\r\n         * 3: - pitch down / + pitch up (rot: X axis clock wise)\r\n         * 4: - roll right / + roll left (rot: Z axis clock wise)\r\n         * 5: - yaw right / + yaw left (rot: Y axis clock wise)\r\n         */\r\n\r\n        var look = new THREE.Vector3(spaceNavigator.axes[3], spaceNavigator.axes[5], spaceNavigator.axes[4])\r\n\r\n        if (look.x < ROTATION_EPS && look.x > -ROTATION_EPS) look.z = 0\r\n        if (look.y < ROTATION_EPS && look.y > -ROTATION_EPS) look.y = 0\r\n        if (look.z < ROTATION_EPS && look.z > -ROTATION_EPS) look.x = 0\r\n\r\n        if (this.data.invertPitch) look.x *= -look.x\r\n\r\n        // If external controls have been active more recently than spaceNavigator,\r\n        // and spaceNavigator hasn't moved, don't overwrite the existing rotation.\r\n        if (tLastExternalActivity > tLastLocalActivity && !look.lengthSq()) return\r\n\r\n        look.multiplyScalar(this.data.rotationSensitivity)\r\n\r\n        this.pitch.rotation.x += look.x\r\n        this.yaw.rotation.y -= look.y\r\n        this.roll.rotation.z += look.z\r\n\r\n        //this.pitch.rotation.x = Math.max(-PI_2, Math.min(PI_2, this.pitch.rotation.x))\r\n\r\n        this.el.setAttribute('rotation', {\r\n          x: this.pitch.rotation.x * RAD_TO_DEG,\r\n          y: this.yaw.rotation.y * RAD_TO_DEG,\r\n          z: this.data.rollEnabled ? this.roll.rotation.z * RAD_TO_DEG : 0\r\n        })\r\n\r\n        prevFinalRotation.copy(this.el.getAttribute('rotation'));\r\n        tLastLocalActivity = tCurrent;\r\n      };\r\n\r\n      return this._updateRotation();\r\n    },\r\n\r\n    updateFov: function (dt) {\r\n      if (this._updateFov) return this._updateFov(dt)\r\n\r\n      var previousScroll = 0\r\n      var self = this\r\n\r\n      this._updateFov = function (dt) {\r\n        var fov = self.el.getAttribute('fov')\r\n        if (fov) {\r\n          // easing\r\n          self.fovVelocity -= self.fovVelocity * 3 * dt / 6000\r\n          // acceleration\r\n          var scrollDelta = previousScroll - self.scroll\r\n          self.fovVelocity += scrollDelta * 10 * dt / 6000\r\n          // applay foy\r\n          fov = Math.max(10, parseFloat(fov) + self.fovVelocity)\r\n          self.el.setAttribute('fov', fov)\r\n          previousScroll = self.scroll\r\n        }\r\n      }\r\n\r\n      return this._updateFov(dt)\r\n    },\r\n\r\n    /*******************************************************************\r\n     * Button events\r\n     */\r\n\r\n    updateButtonState: function () {\r\n      var spaceNavigator = this.getSpaceNavigator();\r\n      if (this.data.enabled && spaceNavigator) {\r\n\r\n        // Fire DOM events for button state changes.\r\n        for (var i = 0; i < spaceNavigator.buttons.length; i++) {\r\n          if (spaceNavigator.buttons[i].pressed && !this.buttons[i]) {\r\n            this.emit(new ButtonEvent('navigatorbuttondown', i, spaceNavigator.buttons[i]));\r\n          } else if (!spaceNavigator.buttons[i].pressed && this.buttons[i]) {\r\n            this.emit(new ButtonEvent('navigatorbuttonup', i, spaceNavigator.buttons[i]));\r\n          }\r\n          this.buttons[i] = spaceNavigator.buttons[i].pressed;\r\n        }\r\n\r\n      } else if (Object.keys(this.buttons)) {\r\n        // Reset state if controls are disabled or controller is lost.\r\n        this.buttons = {};\r\n      }\r\n    },\r\n\r\n    emit: function (event) {\r\n      // Emit original event.\r\n      this.el.emit(event.type, event);\r\n\r\n      // Emit convenience event, identifying button index.\r\n      this.el.emit(\r\n        event.type + ':' + event.index,\r\n        new ButtonEvent(event.type, event.index, event)\r\n      );\r\n    },\r\n\r\n    /*******************************************************************\r\n     * SpaceNavigator state\r\n     */\r\n\r\n    /**\r\n     * Returns SpaceNavigator instance attached to the component. If connected,\r\n     * a proxy-controls component may provide access to spaceNavigator input from a\r\n     * remote device.\r\n     *\r\n     * @return {SpaceNavigator}\r\n     */\r\n    getSpaceNavigator: function () {\r\n      var proxyControls = this.el.sceneEl.components['proxy-controls']\r\n\r\n      if (proxyControls) {\r\n        // use proxy space navigator\r\n        return proxyControls && proxyControls.isConnected() && proxyControls.getSpaceNavigator(this.data.controller)\r\n\r\n      } else {\r\n        // use local space navigator\r\n        return navigator.getGamepads && navigator.getGamepads()[this.data.controller]\r\n\r\n      }\r\n    },\r\n\r\n    /**\r\n     * Returns true if Space Navigator is currently connected to the system.\r\n     * @return {boolean}\r\n     */\r\n    isConnected: function () {\r\n      var spaceNavigator = this.getSpaceNavigator();\r\n      return !!(spaceNavigator && spaceNavigator.connected);\r\n    },\r\n\r\n    /**\r\n     * Returns a string containing some information about the controller. Result\r\n     * may vary across browsers, for a given controller.\r\n     * @return {string}\r\n     */\r\n    getID: function () {\r\n      return this.getSpaceNavigator().id;\r\n    }\r\n\r\n  }\r\n\r\n  // helpers\r\n\r\n  function ButtonEvent (type, index, details) {\r\n    this.type = type;\r\n    this.index = index;\r\n    this.pressed = details.pressed;\r\n    this.value = details.value;\r\n  }\r\n\r\n  // register component\r\n\r\n  if (!AFRAME) {\r\n    console.error('Component attempted to register before AFRAME was available.')\r\n    return\r\n  }\r\n  (AFRAME.aframeCore || AFRAME).registerComponent('space-navigator-controls', spaceNavigatorControls)\r\n\r\n})(window.AFRAME)"],"names":[],"mappings":"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"}